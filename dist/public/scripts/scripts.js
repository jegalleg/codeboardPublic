"use strict";var app=angular.module("codeboardApp",["ngCookies","ngResource","ngSanitize","ngRoute","ngAnimate","ui.ace","angularTreeview","ui.bootstrap","angularFileUpload","ui.select","ngGrid","kendo.directives","chart.js","ngWebSocket","luegg.directives"]);app.config(["ChartJsProvider",function(a){a.setOptions({colours:["#949FB1","#97BBCD"],responsive:!0,maintainAspectRatio:!1,pointHitDetectionRadius:1})}]),app.config(["$logProvider",function(a){a.debugEnabled(!1)}]),app.config(["uiSelectConfig",function(a){a.theme="selectize"}]),app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"partials/main",controller:"MainCtrl"}).when("/signin",{templateUrl:"partials/signin",controller:"SigninCtrl"}).when("/signup",{templateUrl:"partials/signup",controller:"SignupCtrl"}).when("/passwordreset",{templateUrl:"partials/passwordReset",controller:"PasswordResetCtrl"}).when("/users",{templateUrl:"partials/usersAll",controller:"usersAllCtrl"}).when("/users/:username/settings/",{templateUrl:"partials/userSettings",controller:"UserSettingsCtrl",resolve:{userData:["$route","UserResSettings",function(a,b){return b.get({username:a.current.params.username}).$promise}]}}).when("/users/:username/stats/",{templateUrl:"partials/userStats",controller:"UserStatsCtrl"}).when("/users/:username",{templateUrl:"partials/userProjects",controller:"UserProjectsCtrl"}).when("/projects/new",{templateUrl:"partials/projectNew",controller:"ProjectNewCtrl",resolve:{isAuth:["$q","UserSrv",function(a,b){var c=a.defer();return b.isAuthenticated()?c.resolve():c.reject({status:401}),c.promise}]}}).when("/projects/:projectId/settings",{templateUrl:"partials/projectSettings",controller:"ProjectSettingsCtrl",resolve:{projectData:["$route","ProjectSettingsRes",function(a,b){return b.get({projectId:a.current.params.projectId}).$promise}]}}).when("/projects/:projectId/summary",{templateUrl:"partials/projectSummary",controller:"ProjectSummaryCtrl",resolve:{projectSummaryData:["$route","ProjectSummaryRes",function(a,b){return b.get({projectId:a.current.params.projectId}).$promise}]}}).when("/projects/:projectId/stats",{templateUrl:"partials/projectStats",controller:"ProjectStatsCtrl",resolve:{placeHolder:["$route","$http",function(a,b){return b.get("/api/projects/"+a.current.params.projectId+"/authorizedownercheck")}]}}).when("/projects/:projectId/submissions",{templateUrl:"partials/projectSubmissions",controller:"ProjectSubmissionsCtrl",resolve:{placeHolder:["$route","$http",function(a,b){return b.get("/api/projects/"+a.current.params.projectId+"/authorizedownercheck")}]}}).when("/projects/:projectId/userprojects",{templateUrl:"partials/projectUserProjects",controller:"ProjectUserProjectsCtrl",resolve:{placeHolder:["$route","$http",function(a,b){return b.get("/api/projects/"+a.current.params.projectId+"/authorizedownercheck")}]}}).when("/projects/:projectId",{templateUrl:"partials/ide",controller:"IdeCtrl",resolve:{ltiData:["$route","$q",function(a,b){var c=b.defer(),d={};return a.current.params.ltiSessionId&&(d.ltiSessionId=a.current.params.ltiSessionId),a.current.params.ltiUserId&&(d.ltiUserId=a.current.params.ltiUserId),a.current.params.ltiNonce&&(d.ltiNonce=a.current.params.ltiNonce),c.resolve(d),c.promise}],projectData:["$route","ProjectRes",function(a,b){var c=function(){var b=[];return a.current.params.ltiSessionId&&b.push(a.current.params.ltiSessionId),a.current.params.ltiUserId&&b.push(a.current.params.ltiUserId),a.current.params.ltiNonce&&b.push(a.current.params.ltiNonce),b},d=c();return 3==d.length?b.get({projectId:a.current.params.projectId,ltiSessionId:d[0],ltiUserId:d[1],ltiNonce:d[2]}).$promise:b.get({projectId:a.current.params.projectId}).$promise}]}}).when("/projects/:projectId/submissions/:submissionId",{templateUrl:"partials/ide",controller:"IdeCtrl",resolve:{ltiData:["$route","$q",function(a,b){var c=b.defer(),d={};return c.resolve(d),c.promise}],projectData:["$route","$http",function(a,b){return b.get("/api/projects/"+a.current.params.projectId+"/submissions/"+a.current.params.submissionId).then(function(a){var b={projectname:a.data.project.projectname,language:a.data.project.language,userRole:"submission",username:a.data.user.username};b.fileSet=a.data.userFilesDump.concat(a.data.hiddenFilesDump);var c=0;return b.fileSet.every(function(a){a.uniqueId>c&&(c=a.uniqueId)}),b.lastUId=c,b.isSubmissionAllowed=!1,b})}]}}).when("/projects/:projectId/userprojects/:userprojectId",{templateUrl:"partials/ide",controller:"IdeCtrl",resolve:{ltiData:["$route","$q",function(a,b){var c=b.defer(),d={};return c.resolve(d),c.promise}],projectData:["$route","UserProjectRes",function(a,b){return b.get({projectId:a.current.params.projectId,userprojectId:a.current.params.userprojectId}).$promise}]}}).when("/projects",{templateUrl:"partials/projectsAll",controller:"projectsAllCtrl"}).when("/support/lti/debug",{templateUrl:"partials/supportLtiDebug",controller:"SupportCtrl"}).when("/404",{templateUrl:"partials/404"}).when("/401",{templateUrl:"partials/401"}).otherwise({redirectTo:"/404"}),b.html5Mode(!0)}]),app.run(["$rootScope","$route","$location","UserSrv",function(a,b,c,d){a.$on("$routeChangeStart",function(a,b,c,e){window.onbeforeunload=null,d.isAuthenticated()||d.tryAuthenticateUser()}),a.$on("$routeChangeError",function(a,b,d,e){401===e.status?c.path("/401").replace():c.path("/404").replace()})}]),angular.module("codeboardApp").controller("MainCtrl",["$scope","$rootScope","$http","$location","UserSrv",function(a,b,c,d,e){a.authFailed=!1,a.init=function(){e.isAuthenticated()&&d.path("/users/"+e.getUsername())}(),a.login=function(b){a.authFailed=!1;var e={username:b.username,password:b.password};c.post("/api/session",e).success(function(a,b,c,e){d.path("/users/"+a.username)}).error(function(b,c,d,e){console.log("Auth failed"),a.authFailed=!0})}}]),angular.module("codeboardApp").controller("NavbarCtrl",["$scope","$location","UserSrv",function(a,b,c){a.username=c.getUsername(),a.isAuth=c.isAuthenticated(),a.$on("userLoggedIn",function(b,d){a.username=c.getUsername(),a.isAuth=c.isAuthenticated()}),a.signOut=function(){c.signOutUser()}}]),angular.module("codeboardApp").controller("SignupCtrl",["$scope","$rootScope","$http","$location",function(a,b,c,d){a.data={},a.serverError={userExists:!1,emailExists:!1,hasErrors:!1,errorMsg:""},a.submitted=!1,a.currentlySubmitting=!1,a.register=function(b){if(a.submitted=!0,b.$valid&a.data.password===a.data.passwordConfirm&&0==a.currentlySubmitting){a.currentlySubmitting=!0;var e={username:a.data.username,password:a.data.password,email:a.data.email};c.post("/api/users",e).success(function(b,e,f,g){a.serverError.userExists=!1,a.serverError.emailExists=!1,a.currentlySubmitting=!1,c.post("/api/session",{username:a.data.username,password:a.data.password}).success(function(a,b,c,e){d.path("/users/"+a.username)})}).error(function(b,c){422===c?(a.serverError.hasErrors=!0,a.serverError.errorMsg=b.msg):409===c?("UserExists"===b.error&&(a.serverError.userExists=!0),"EmailExists"===b.error&&(a.serverError.emailExists=!0)):(a.serverError.hasErrors=!0,a.serverError.errorMsg=b.msg),a.currentlySubmitting=!1})}}}]),angular.module("codeboardApp").controller("SigninCtrl",["$scope","$rootScope","$http","$location","$routeParams",function(a,b,c,d,e){a.formData={},a.signinFailed=!1,a.signin=function(b){a.submitted=!0;var f={username:b.username,password:b.password};c.post("/api/session",f).success(function(a,b,c,f){e.redirect?d.url(e.redirect):d.path("/users/"+a.username)}).error(function(b,c){a.signinFailed=!0,401===c?a.formData.error="Invalid username, email or password.":a.formData.error="Unknown error. Please try again."})}}]),angular.module("codeboardApp").controller("PasswordResetCtrl",["$scope","$rootScope","$http","$location","$routeParams",function(a,b,c,d,e){a.formData={},a.submitted=!1,a.isUnderSubmission=!1,a.server={resetSuccess:!1,errorUnknownFailure:!1,errorEmailUnknown:!1},a.resetPassword=function(b){a.submitted=!0,a.isUnderSubmission=!0,a.server.resetSuccess=!1,a.server.errorEmailUnknown=!1,a.server.errorUnknownFailure=!1;var d={email:b.email};c.put("/api/passwordreset",d).success(function(b,c,d,e){a.server.resetSuccess=!0,a.isUnderSubmission=!1}).error(function(b,c){a.isUnderSubmission=!1,403===c?a.server.errorEmailUnknown=!0:a.server.errorUnknownFailure=!0})}}]);var app=angular.module("codeboardApp");app.controller("IdeCtrl",["$scope","$rootScope","$log","$sce","$location","$routeParams","$window","$http","$timeout","$uibModal","ProjectFactory","projectData","ltiData","IdeMsgService","IdeSnippetsSrv","UserSrv","WebsocketSrv",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){k.setProjectFromJSONdata(l,m);var r=function(){if("user"==k.getProject().userRole&&p.isAuthenticated()){var a="/api/users/"+p.getUsername()+"/projects/"+f.projectId;f.ltiSessionId&&f.ltiUserId&&f.ltiNonce&&(a+="?ltiSessionId="+f.ltiSessionId+"&ltiUserId="+f.ltiUserId+"&ltiNonce="+f.ltiNonce),h.get(a).success(function(a){var d=["$scope","$uibModalInstance","UserSrv",function(a,b,c){a.ok=function(){b.close()},a.cancel=function(){b.dismiss()},a.getUsername=function(){return c.getUsername()}}],e=function(a,e){var f=j.open({templateUrl:"ideLoadUserProjectModal.html",controller:d});f.result.then(function(){c.debug("User confirmed to load saved project."),a&&a(),b.$broadcast(n.msgProcessViewQueryStringRequest().msg)},function(){c.debug("User canceled loading of the saved project."),e&&e(),b.$broadcast(n.msgProcessViewQueryStringRequest().msg)})};e(function(){var c={name:k.getProject().name,lastUId:a.project.lastUId,language:k.getProject().language,userRole:k.getProject().userRole,fileSet:a.files};k.setProjectFromJSONdata(c,m,k.getProject().staticFiles),b.$broadcast(n.msgReloadTreeFromProjectFactory().msg)})}).error(function(a){c.debug(a),b.$broadcast(n.msgProcessViewQueryStringRequest().msg)})}else b.$broadcast(n.msgProcessViewQueryStringRequest().msg)};g.onbeforeunload=function(a){var b="You currently have unsaved changes.";return u(),"undefined"==typeof a&&(a=window.event),a&&k.isProjectModified()?(a.returnValue=b,b):null},a.$on("$locationChangeStart",function(a){if(u(),k.isProjectModified()){var b="You currently have unsaved changes.\n\nAre you sure you want to leave this page?",c=confirm(b);c||a.preventDefault()}});var s=function(){if(f.view){c.debug('idejs.processViewQueryString: Found a "view" query string in the URL: '+f.view);for(var a=[],d=f.view.split("-"),e=0;e<d.length;e++){var g=d[e].split(".");if(2!=g.length||!isNaN(g[0])||!isNaN(g[1])){var h=parseInt(g[0]),i=parseInt(g[1]);if(k.hasNode(h)&&!k.getNode(h).isFolder){var j={nodeId:h,nodeActive:i};a.push(j)}}}for(var e=0;e<a.length;e++){var l=n.msgDisplayFileRequest(a[e].nodeId);b.$broadcast(l.msg,l.data)}for(var e=0;e<a.length;e++)if(a[e].nodeActive){var l=n.msgDisplayFileRequest(a[e].nodeId);b.$broadcast(l.msg,l.data)}}},t=function(d,e,g){var i=0,j=15e3,l=g||!a.isCompilationNeeded();v("",l);var m=function(){h.get(e).then(function(d){a.mantraID=e.split("/")[3],c.debug("websocketSrvjs.onOpen: container successfully started"),D.actionAllowsForStopping&&b.$broadcast(n.msgStoppableActionAvailable().msg)},function(a){c.debug("websocketSrvjs.onOpen: problem starting container."),c.debug(a)})},o=[],r=function(b){var c=w(b,l);o.push(b),a.mensajeEnviado=!0,i+=1,c>j&&(w("\n\nYour program output has more than "+j+" characters. That's quite a lot.\nFor this reason, Codeboard has terminated your program.\n\n",l),q.close(!0))},s=function(){var c;c=""==p.getUsername()?"anonymous":p.getUsername();var d="/api/"+c+"/test",e={date:a.startT,user:c,id:a.mantraID,projectId:f.projectId,action:a.accion,project:k.getProject(),output:o.toString()},g=JSON.stringify(e);h({method:"POST",url:d,data:g,timeout:4e3}).then(function(a){}),0===i&&w("--Session ended without output.--",!1),b.$broadcast(n.msgStoppableActionGone().msg),F(1,1,1,1,1)};q.connect(d,m,r,s)},u=function(){a.ace.currentNodeId!==-1&&(k.getNode(a.ace.currentNodeId).content=a.ace.editor.getSession().getValue())},v=function(b,c){a.renderHtmlOutput=!1,c&&!a.uiSettings.showOutputAsText?(a.output="",a.htmlOutput=d.trustAsHtml(b),a.renderHtmlOutput=!0):(a.output=b,a.htmlOutput="",a.renderHtmlOutput=!1)};v("This will display the output.",!1);var w=function(b,c){if(a.renderHtmlOutput=!1,c&&!a.uiSettings.showOutputAsText){var e=a.htmlOutput+b;a.htmlOutput=d.trustAsHtml(e),a.renderHtmlOutput=!0}else a.output+=b,a.renderHtmlOutput=!1;return a.output.length+(a.htmlOutput.$$unwrapTrustedValue?a.htmlOutput.$$unwrapTrustedValue().length:0)};"WebSocket"in window&&("function"==typeof WebSocket||"object"==typeof WebSocket)?c.debug("Info: Browser supports WebSockets"):v("Warning: your browser does not support WebSockets.\nThis may cause Codeboard to not work properly.\nPlease consider updating to a newer browser.",!1);var x=function(a){u(),v("Waiting for results...",!1),F(0,0,0,0,0);var d=k.compileProject(a);d.then(function(a){D.stopUrl=a.stopUrl,t(a.streamUrl,a.startUrl)},function(a){c.debug("Error while trying to run your program. The server responded:\n"+a),v("Error while trying to run your program. The server responded:\n"+a,!1),F(1,0,0,1,0),b.$broadcast(n.msgStoppableActionGone().msg)})},y=function(){v("Waiting for results...",!1),F(0,0,0,0,0),k.runProject().then(function(a){D.stopUrl=a.stopUrl,t(a.streamUrl,a.startUrl,!0)},function(a){c.debug("Error when trying to run your program. The server responded:\n"+a),v("Error when trying to run your program. The server responded:\n"+a,!1),F(1,0,0,1,0),b.$broadcast(n.msgStoppableActionGone().msg)}),a.ace.editor.focus()},z=function(){u(),v("Testing your solution. This might take a few seconds. Please wait...",!1),F(0,0,0,0,0);var a=k.testProject();a.then(function(a){c.debug("Testing successful."),a.compilationError?v("Testing failed. Your program does not compile.\nFix all compilation errors and try again.\n\n--- Details ---\n\n"+a.outputCompiler,!1):v("Number of passing tests: "+a.numTestsPassing+"\nNumber of failing tests: "+a.numTestsFailing+"\n\n--- Details ---\n\n"+a.output,!1),F(1,0,1,1,1)},function(a){c.debug("Error while trying to test your program. The server responded:\n"+a),v("Error while trying to test your program. The server responded:\n"+a,!1),F(1,0,1,1,0)})},A=function(){u(),v("Analyzing your project. This might take a few seconds. Please wait...",!1),F(0,0,0,0,0);var a=k.toolAction();a.then(function(a){c.debug("Tool action successful."),a.compilationError?v("Analysis failed. Your program does not compile.\nFix all compilation errors and try again.\n\n--- Details ---\n\n"+a.outputCompiler,!1):v(a.output,!1),F(1,0,1,1,1)},function(a){c.debug("Error while running the tool-action on your program. The server responded:\n"+a),v("Error while running the requested action on your program. The server responded:\n"+a,!1),F(1,0,1,1,0)})},B=function(){u(),v("Submitting your solution. This might take a few seconds. Please wait...",!1),F(0,0,0,0,0);var a=k.submitProject();a.then(function(a){c.debug("Submission successful."),v(a.msg,!1),F(1,0,1,1,1)},function(a){c.debug("Submission failed."+a.data.msg),v(a.data.msg,!1),F(1,0,1,1,1)})},C=function(){D.stopUrl&&h.get(D.stopUrl).success(function(a,b,c,d){w("\n\n--Program stopped--",!0)}).error(function(a,b,d,e){c.debug("An error occurred while trying to stop your program."),w("\n\nAn error occurred while trying to stop your program.",!0)})},D={actionAllowsForStopping:!1,stopUrl:""};a.projectName=k.getProject().name,a.ace={currentNodeId:-1,editor:null,isVisible:!1},a.aceLoaded=function(b){a.ace.editor=b},a.uiSettings={showSubmissionBtn:l.isSubmissionAllowed,showOutputAsText:!1},a.disabledActions={compile:!1,run:!0,stop:!0,test:!0,tool:!1,submit:!0},a.hiddenActions={compileDynamic:!1,run:!1,stop:!0},a.aceEditorSettings={theme:"eclipse",fontSize:"12px",handler:"ace",tabSize:4,invisibles:"Hide",gutter:"Show"};var E;a.signinSettings={userIsAuthenticated:function(){return p.isAuthenticated()},signinPathWithRedirect:function(){return"/signin?redirect="+encodeURIComponent(e.url())}};var F=function(b,c,d,e,f){a.disabledActions.compile=!(1==b),a.disabledActions.run=!(1==c),a.disabledActions.test=!(1==d),a.disabledActions.tool=!(1==e),a.disabledActions.submit=!(1==f),a.$$phase||a.$digest()};a.currentUserIsOwner=function(){return"owner"===k.getProject().userRole},a.currentRoleIsOwner=function(){return"owner"===k.getProject().userRole},a.currentRoleIsUser=function(){return"user"===k.getProject().userRole},a.currentRoleIsSubmission=function(){return"submission"===k.getProject().userRole},a.currentRoleIsUserProject=function(){return"userproject"===k.getProject().userRole},a.navBarClick=function(d){switch(a.accion=d,a.mensajeEnviado=!1,c.debug("NavBarClick with id: "+d),d){case"add_file":var e=n.msgNewNodeRequest("file");b.$broadcast(e.msg,e.data);break;case"add_folder":var e=n.msgNewNodeRequest("folder");b.$broadcast(e.msg,e.data);break;case"rename_node":var e=n.msgRenameNodeRequest();b.$broadcast(e.msg);break;case"remove_node":var e=n.msgRemoveNodeRequest();b.$broadcast(e.msg);break;case"save_project":var e=n.msgSaveProjectRequest();b.$broadcast(e.msg);break;case"hide_file":var e=n.msgHideNodeRequest();b.$broadcast(e.msg);break;case"show_share_project":var e=n.msgShowShareProjectModalRequest();b.$broadcast(e.msg);break;case"show_editor_settings":var e=n.msgShowEditorSettingsRequest(a.aceEditorSettings);b.$broadcast(e.msg,e.data);break;case"show_output_as_text":var e=n.msgShowOutputAsText();b.$broadcast(e.msg);break;case"compile":if(!a.disabledActions.compile){var e=n.msgCompileRequest();b.$broadcast(e.msg),a.startT=new Date}break;case"compileDynamic":if(!a.disabledActions.compile){var e=n.msgCompileRequest();b.$broadcast(e.msg),a.startT=new Date,D.actionAllowsForStopping=!0}break;case"compile_clean":if(!a.disabledActions.compile){var e=n.msgCompileCleanRequest();a.startT=new Date,b.$broadcast(e.msg)}break;case"run":if(!a.disabledActions.run){a.startT=new Date;var e=n.msgRunRequest();b.$broadcast(e.msg),D.actionAllowsForStopping=!0}break;case"stop":var e=n.msgStopRequest();b.$broadcast(e.msg);break;case"test":if(!a.disabledActions.test){var e=n.msgTestRequest();b.$broadcast(e.msg)}break;case"tool":if(!a.disabledActions.tool){var e=n.msgToolRequest();b.$broadcast(e.msg)}break;case"submit":if(!a.disabledActions.submit){var e=n.msgSubmitRequest();b.$broadcast(e.msg)}}},a.$on(n.msgDisplayFileRequest().msg,function(b,d){if(a.ace.currentNodeId!==-1&&(k.getNode(a.ace.currentNodeId).session=a.ace.editor.getSession(),k.getNode(a.ace.currentNodeId).content=a.ace.editor.getSession().getValue()),void 0!==k.getNode(d.nodeId).session&&null!==k.getNode(d.nodeId).session)a.ace.editor.setSession(k.getNode(d.nodeId).session);else{var e=k.getNode(d.nodeId),f=e.content,g="ace/mode/text",i=e.filename.split(".").pop();switch(i){case"e":g="ace/mode/eiffel";break;case"ecf":g="ace/mode/xml";break;case"java":g="ace/mode/java";break;case"html":g="ace/mode/html";break;case"htm":g="ace/mode/html";break;case"py":g="ace/mode/python";break;case"c":g="ace/mode/c_cpp";break;case"h":g="ace/mode/c_cpp";break;case"cpp":g="ace/mode/c_cpp";break;case"hs":g="ace/mode/haskell";break;case"json":g="ace/mode/json";break;default:g="ace/mode/text"}a.ace.editor.setSession(ace.createEditSession(f,g)),E=a.ace.editor.getKeyboardHandler(),"ace/mode/haskell"===g?a.ace.editor.getSession().setTabSize(8):a.ace.editor.getSession().setTabSize(4);var j=ace.require("ace/snippets").snippetManager;ace.require("ace/config");ace.config.loadModule("ace/ext/language_tools",function(){a.ace.editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!1})}),"ace/mode/eiffel"==g&&ace.config.loadModule("ace/snippets/eiffel",function(a){if(a){j.files.eiffel=a,a.snippetText="snippet feature modifier\n\tfeature {${1:CLASS}} -- ${2:comment}  \n",a.snippets=j.parseSnippetFile(a.snippetText);for(var b=0;b<o.getEiffelSnippet().length;b++)a.snippets.push(o.getEiffelSnippet()[b]);j.register(a.snippets,a.scope)}}),e.url&&!e.isContentSet&&h.get(e.url).success(function(b){c.debug("Got HTTP response for content of the file"),k.getNode(d.nodeId).content=b,k.getNode(d.nodeId).isContentSet=!0,a.ace.editor.getSession().setValue(b)}).error(function(a){c.debug(a)})}"string"==typeof d.nodeId&&"s"===d.nodeId.charAt(0)?a.ace.editor.setReadOnly(!0):a.ace.editor.setReadOnly(!1),a.ace.currentNodeId=d.nodeId,a.ace.editor.focus()}),a.splitterResizeEvent=function(){var a=n.msgEditorResizeRequest();b.$broadcast(a.msg)},a.$on(n.msgEditorResizeRequest().msg,function(){a.ace.editor.resize()}),a.$on(n.msgSaveProjectRequest().msg,function(){c.debug("Save request received"),u(),k.saveProjectToServer().then(function(a){v('<span style="color: green;">Changes successfully saved.</span>',!0),i(function(){v("This will display the output.",!1)},2500)},function(a){v('<span style="color: red">WARNING: Unable to save your changes.<br><br>What now: maybe you\'re currently not logged in.<br>Open a new browser tab for codeboard.io, login, and then come back to this tab and try to save your changes.<br>If the problem persists, contact us at: info@codeboard.io</span>',!0)}),a.ace.editor.focus()}),a.$on(n.msgShowEditorSettingsRequest().msg,function(a,b){var d=["$rootScope","$scope","$uibModalInstance",function(a,c,d){var e=angular.copy(b.settings);c.editorSettings=angular.copy(b.settings),c.ok=function(){var b=n.msgEditorSettingsChanged(c.editorSettings);a.$broadcast(b.msg,b.data),d.close()},c.preview=function(){var b=n.msgEditorSettingsChanged(c.editorSettings);a.$broadcast(b.msg,b.data)},c.cancel=function(){var b=n.msgEditorSettingsChanged(e);a.$broadcast(b.msg,b.data),d.dismiss()}}],e=function(a,b){var e=j.open({templateUrl:"ideEditorSettingsModal.html",controller:d});e.result.then(function(){c.debug("User confirmed changes to editor settings."),a&&a()},function(){c.debug("User canceled changes to editor settings."),b&&b()})};e(function(){},function(){})}),a.$on(n.msgEditorSettingsChanged().msg,function(b,c){a.aceEditorSettings=c.settings,"ace"!=a.aceEditorSettings.handler?a.ace.editor.setKeyboardHandler("ace/keyboard/"+a.aceEditorSettings.handler):a.ace.editor.setKeyboardHandler(E),a.ace.editor.setTheme("ace/theme/"+a.aceEditorSettings.theme),a.ace.editor.setFontSize(a.aceEditorSettings.fontSize),a.ace.editor.getSession().setTabSize(a.aceEditorSettings.tabSize),"Show"===a.aceEditorSettings.invisibles?a.ace.editor.setShowInvisibles(!0):a.ace.editor.setShowInvisibles(!1),"Show"===a.aceEditorSettings.gutter?a.ace.editor.renderer.setShowGutter(!0):a.ace.editor.renderer.setShowGutter(!1)}),a.$on(n.msgShowOutputAsText().msg,function(){a.uiSettings.showOutputAsText=!a.uiSettings.showOutputAsText}),a.$on(n.msgCompileRequest().msg,function(){c.debug("Compile request received"),x(!1),a.ace.editor.focus()}),a.$on(n.msgCompileCleanRequest().msg,function(){c.debug("Clean-compile request received"),x(!0),a.ace.editor.focus()}),a.$on(n.msgRunRequest().msg,function(){c.debug("Run request received"),y()}),a.$on(n.msgStopRequest().msg,function(){c.debug("Stop request received"),C()}),a.$on(n.msgTestRequest().msg,function(){c.debug("Test request received"),z(),a.ace.editor.focus()}),a.$on(n.msgToolRequest().msg,function(){c.debug("Tool request received"),A(),a.ace.editor.focus()}),a.$on(n.msgSubmitRequest().msg,function(){if(c.debug("Submit request received"),p.isAuthenticated()||k.getProject().hasLtiData)B();else{var b=["$scope","$uibModalInstance",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}],d=function(a,d){var e=j.open({templateUrl:"ideConfirmAnonymousSubmissionModal.html",controller:b});e.result.then(function(){c.debug("User confirmed submit anonymously."),a&&a()},function(){c.debug("User canceled anonymous submission."),d&&d()})};d(B)}a.ace.editor.focus()}),a.$on(n.msgDisplayEditorRequest().msg,function(b,c){c.displayEditor?a.ace.isVisible=!0:a.ace.isVisible=!1}),a.$on(n.msgRemoveNodeConfirmation().msg,function(b,c){a.ace.currentNodeId===c.uniqueId&&(a.ace.currentNodeId=-1)}),a.$on(n.msgStoppableActionAvailable().msg,function(){c.debug("Event received: Stoppable action available"),a.hiddenActions.compileDynamic=!0,a.hiddenActions.run=!0,a.hiddenActions.stop=!1}),a.$on(n.msgStoppableActionGone().msg,function(){c.debug("Event received: Stoppable action gone"),a.hiddenActions.compileDynamic=!1,a.hiddenActions.run=!1,a.hiddenActions.stop=!0,D.actionAllowsForStopping=!1}),a.$on(n.msgProcessViewQueryStringRequest().msg,function(){i(function(){s()})}),a.isCompilationNeeded=function(){var a=["Python","Python-UnitTest"],b=!0;return a.indexOf(k.getProject().language)!==-1&&(b=!1),b},a.isTestSupported=function(){var a=["Haskell-HSpec","Java-JUnit","Python-UnitTest"],b=!1;return a.indexOf(k.getProject().language)!==-1&&(b=!0),b},a.isToolSupported=function(){var a=["Infer-Java"],b=!1;return a.indexOf(k.getProject().language)!==-1&&(b=!0),b},a.isEiffelLanguageCompatible=function(){return"Eiffel"===k.getProject().language},a.sendUserInputClick=function(a,b){a?q.sendData(a+"\n"):q.sendData("\n");var c=angular.element(document.querySelector("#"+b));c&&c.focus()},r()}]),app.controller("TreeCtrl",["$scope","$rootScope","$log","ProjectFactory","IdeMsgService",function(a,b,c,d,e){a.projectNodes=d.getProject().files,a.addFile=function(){var a=e.msgNewNodeRequest("file");b.$broadcast(a.msg,a.data)},a.addFolder=function(){var a=e.msgNewNodeRequest("folder");b.$broadcast(a.msg,a.data)},a.nodeClick=function(){var c=d.getNode(a.mytree.currentNode.uniqueId);if(null!=c&&!c.isFolder){var f=e.msgDisplayFileRequest(c.uniqueId);b.$broadcast(f.msg,f.data)}},a.$on(e.msgRenameNodeRequest().msg,function(c){if(0===a.mytree.currentNode.uniqueId)alert("The root folder can't be renamed.");else{var f=a.mytree.currentNode.uniqueId,g=d.getNode(f).filename,h=d.getNode(f).isFolder?"folder":"file",i=e.msgDisplayRenameNodeModalRequest(f,g,h);b.$broadcast(i.msg,i.data)}}),a.$on(e.msgRenameNodeNameAvailable().msg,function(a,c){d.renameNode(c.nodeId,c.nodeName),b.$broadcast(e.msgReloadTreeFromProjectFactory().msg)}),a.$on(e.msgRemoveNodeRequest().msg,function(c){if(0===a.mytree.currentNode.uniqueId)alert("The root folder can't be deleted.");else{var f=d.getNode(a.mytree.currentNode.uniqueId).filename,g=d.getNode(a.mytree.currentNode.uniqueId).isFolder?"folder":"file",h="Do you really want to delete "+g+" '"+f+"'?",h=d.getNode(a.mytree.currentNode.uniqueId).isFolder?h+"\n\nNote: when deleting a folder, make sure it's empty.":h,i=confirm(h);if(i){var j=a.mytree.currentNode.uniqueId;d.removeNode(j,!1),d.getNode(0).selected="selected",a.mytree.currentNode=d.getNode(0);var k=e.msgRemoveNodeConfirmation(j);b.$broadcast(k.msg,k.data)}}}),a.$on(e.msgNewNodeNameAvailable().msg,function(b,c){var e=a.mytree.currentNode.uniqueId;switch(c.nodeType){case"file":d.addFile(e,c.nodeName);break;case"folder":d.addFolder(e,c.nodeName)}}),a.$on(e.msgReloadTreeFromProjectFactory().msg,function(b){a.projectNodes=d.getProject().files}),a.$on(e.msgHideNodeRequest().msg,function(){c.debug("Hide_node request received");var b=a.mytree.currentNode.uniqueId;b>0?(c.debug("Node is hidden: "+d.getNode(b).isHidden),d.setNodeHidden(d.getNode(b)),c.debug("Node is hidden: "+d.getNode(b).isHidden)):alert("The root folder can't be hidden.")})}]),app.controller("TabCtrl",["$scope","$rootScope","$log","$uibModal","ProjectFactory","IdeMsgService",function(a,b,c,d,e,f){a.tabs=[];var g=function(b){for(var c=0;c<a.tabs.length;c++)a.tabs[c].isActive=c===b},h=function(b){for(var c=0;c<a.tabs.length;c++)if(a.tabs[c].nodeIndex===b)return c;return-1};a.selectClick=function(c){var d=f.msgDisplayFileRequest(a.tabs[c].nodeIndex);b.$broadcast(d.msg,d.data)},a.closeClick=function(d){c.debug("Close-tab clicked; array-index:"+d);for(var e=d+1;e<a.tabs.length;e++)a.tabs[e].arrayIndex=a.tabs[e].arrayIndex-1;if(a.tabs[d].isActive)if(1===a.tabs.length){var g=f.msgDisplayEditorRequest(!1);b.$broadcast(g.msg,g.data)}else if(0===d){var g=f.msgDisplayFileRequest(a.tabs[d+1].nodeIndex);b.$broadcast(g.msg,g.data)}else{var g=f.msgDisplayFileRequest(a.tabs[d-1].nodeIndex);b.$broadcast(g.msg,g.data)}a.tabs.splice(d,1)},a.$on(f.msgDisplayFileRequest().msg,function(c,d){if(0===a.tabs.length){var i=f.msgDisplayEditorRequest(!0);b.$broadcast(i.msg,i.data)}var j=h(d.nodeId);if(j===-1){var k=e.getNode(d.nodeId);a.tabs.push({name:k.filename,title:k.path+"/"+k.filename,nodeIndex:d.nodeId,arrayIndex:a.tabs.length,isActive:!1}),g(a.tabs.length-1)}else g(j)}),a.$on(f.msgRenameNodeNameAvailable().msg,function(b,c){var d=h(c.nodeId);d!==-1&&(a.tabs[d].name=c.nodeName)}),a.$on(f.msgRemoveNodeConfirmation().msg,function(b,c){var d=h(c.uniqueId);d!==-1&&a.closeClick(d)}),a.$on(f.msgShowShareProjectModalRequest().msg,function(b,c){var e=a.tabs,f=["$rootScope","$scope","$location","$uibModalInstance",function(a,b,c,d){var f=function(){var a=c.absUrl(),b=a.indexOf("?");return b>=0&&(a=a.substr(0,b)),a};b.form={inputText:f(),inputCheckbox:!1},b.checkboxChanged=function(){if(b.form.inputText=f(),b.form.inputCheckbox){var a="";if(e.length>0){a+="?view=";for(var c=0;c<e.length;c++)a+=e[c].nodeIndex+"."+(e[c].isActive?"1":"0"),a+=c<e.length-1?"-":""}b.form.inputText+=a}},b.closeModal=function(){d.close()}}];d.open({templateUrl:"ideShareProjectModal.html",controller:f})})}]),app.controller("LibraryCtrl",["$scope","$rootScope","$http","ProjectFactory","IdeMsgService",function(a,b,c,d,e){a.file={},a.files=[];(function(){c.get("staticfiles/eiffelfiles.json").success(function(b){a.files=b}).error(function(a){console.log(a)})})();a.showFile=function(){var c=e.msgDisplayFileRequest(a.file.selected.index);b.$broadcast(c.msg,c.data),a.file={}},a.foo=function(){alert("Click")},a.fetchStaticFiles=function(){c.get("staticfiles/eiffelfiles.json").success(function(a){d.getProject().staticFiles=a}).error(function(a){})}()}]),app.controller("IdeFooterStatusBarCtrl",["$scope","$routeParams","UserSrv","ProjectFactory",function(a,b,c,d){a.getUsername=function(){var b="User: ";return b+=c.isAuthenticated()?c.getUsername():'#anonymous (<a href="'+a.signinSettings.signinPathWithRedirect()+'">sign in</a> to save your progress)'},a.getRole=function(){if(a.currentRoleIsOwner())return"Project owner";if(a.currentRoleIsUser())return"Project user";if(a.currentRoleIsSubmission()){var b="Inspection of a submission";return d.getProject().userBeingInspected&&(b='Inspecting submission from user "'+d.getProject().userBeingInspected+'"'),b}if(a.currentRoleIsUserProject()){var c="Inspection of a user's project";return d.getProject().userBeingInspected&&(c='Inspecting user-project from user "'+d.getProject().userBeingInspected+'"'),c}},a.isUsingLti=function(){return d.getProject().hasLtiData}}]);var app=angular.module("codeboardApp");app.controller("IdeNodeActionCtrl",["$scope","$rootScope","$uibModal","$log","IdeMsgService",function(a,b,c,d,e){var f={ADD_NODE_OPERATION:"add",RENAME_NODE_OPERATION:"rename",NODE_TYPE_FILE:"file",NODE_TYPE_FOLDER:"folder"},g=function(a,g,h,i){var j=["$scope","$uibModalInstance","data",function(a,b,c){a.data={nodeName:c.nodeName,nodeType:c.nodeType,operationType:c.operationType},a.labels={heading:"Add file",label:"Enter the name of the new file:",btnOk:"Add file",btnCancel:"Cancel"};(function(){c.operationType===f.RENAME_NODE_OPERATION?(a.labels.heading="Rename "+c.nodeType,a.labels.label="Enter a new name for "+c.nodeName+":",a.labels.btnOk="Rename "+c.nodeType):c.operationType===f.ADD_NODE_OPERATION&&(a.labels.heading="Add "+c.nodeType,a.labels.label="Enter the name of the new "+c.nodeType+":",a.labels.btnOk="Add "+c.nodeType)})();a.ok=function(){b.close(a.data)},a.cancel=function(){b.dismiss("cancel")},a.submit=function(b){a.data.nodeName=b.nodeName,a.ok()},a.isValid=function(b){var c=/^[0-9a-zA-Z\-\_\.]+\.{1}[0-9a-zA-Z]{1,4}$/,d=/^[0-9a-zA-Z\-\_\.]+$/,e=c;return a.data.nodeType===f.NODE_TYPE_FOLDER&&(e=d),{test:function(a){return e.test(a)}}}(),a.getFormDataErrorMsg=function(){return a.data.nodeType===f.NODE_TYPE_FILE?"Filename format: only use characters a-Z, numbers 0-9, '.', '-', and '_'. Make sure to provide a filename extension. Example: My_File.txt":"Foldername format: only use characters a-Z, numbers 0-9, '.', '-', and '_'. Example: My_Folder";
}}],k=c.open({templateUrl:"ideNewNodeModal.html",controller:j,size:"sm",resolve:{data:function(){return{nodeName:g,nodeType:h,operationType:i}}}});k.result.then(function(c){if(c.operationType===f.ADD_NODE_OPERATION){var d=e.msgNewNodeNameAvailable(c.nodeName,c.nodeType);b.$broadcast(d.msg,d.data)}else if(c.operationType===f.RENAME_NODE_OPERATION){var d=e.msgRenameNodeNameAvailable(a,c.nodeName);b.$broadcast(d.msg,d.data)}},function(){d.debug("Modal dismissed by user.")})};a.$on(e.msgNewNodeRequest().msg,function(a,b){var c="",d="file"===b.nodeType?f.NODE_TYPE_FILE:f.NODE_TYPE_FOLDER;g(-1,c,d,f.ADD_NODE_OPERATION)}),a.$on(e.msgDisplayRenameNodeModalRequest().msg,function(a,b){var c=b.nodeId,d=b.nodeName,e="file"===b.nodeType?f.NODE_TYPE_FILE:f.NODE_TYPE_FOLDER;g(c,d,e,f.RENAME_NODE_OPERATION)})}]),angular.module("codeboardApp").controller("usersAllCtrl",["$scope","$http",function(a,b){a.users=[];(function(){b.get("/api/users").success(function(b){a.users=b}).error(function(a){})})()}]),angular.module("codeboardApp").controller("UserProjectsCtrl",["$scope","$rootScope","$routeParams","$http","$location","$route","UserSrv",function(a,b,c,d,e,f,g){a.user={},a.ownerSet={},a.userSet={},a.currentUserIsSelf=!1,a.init=function(){d.get("/api/users/"+c.username+"/projects").success(function(b){a.user={username:b.username,name:b.name,email:b.emailPublic,url:b.url,location:b.location,institution:b.institution,imageUrl:b.imageUrl},a.ownerSet=b.ownerSet,a.userSet=b.userSet,a.currentUserIsSelf=g.isAuthenticated()&&b.username===g.getUsername()}).error(function(a){e.path("/404").replace()})}()}]),angular.module("codeboardApp").controller("UserStatsCtrl",["$scope","$log","$route","$http","StatsSrv",function(a,b,c,d,e){a.usuarioElegido=!1,a.globalSelected=!1,a.errorsSelected=!1,a.globalPerProjectVisible=!1,a.globalPerTimeVisible=!1,a.errorsPerProjectVisible=!1,a.errorsPerTimeVisible=!1,a.fromDate=new Date,a.fromDate.setMonth(a.fromDate.getMonth()-1),a.untilDate=new Date,a.datePickerMaxSelectableDate=new Date,a.datePickerDateFormat="dd-MMMM-yyyy",a.datePickerFromOpen=!1,a.datePickerUntilOpen=!1,a.projectId=1,a.username=c.current.params.username,a.isLoadingCompilationRunGraphData=!1,a.isLoadingUserAccessGraphData=!0,a.isLoadingCompilationRunGraphDataDetail=!1,a.isLoadingCompilationRunGraphDataTime=!1,a.compilationRunTableVisible=!1,a.projectAccessTableVisible=!1,a.compilationRunTableVisibleDetail=!1,a.submissionTableVisible=!1,a.isLoadingCompilationRunDetails=!1,a.isLoadingProjectAccessDetails=!1,a.isLoadingSubmissionsDetails=!1,a.compilationRunBtnLabel="Show user details",a.compilationRunBtnLabelGraph="Show compilation details",a.projectAccessBtnLabel="Show user details",a.submissionBtnLabel="Show user details",a.changeGlobal=function(){0==a.usuarioElegido?alert("Please, select an user"):(a.globalSelected=!a.globalSelected,a.errorsSelected=!1,a.errorsPerProjectVisible=!1,a.errorsPerTimeVisible=!1,0==a.globalSelected&&(a.globalPerProjectVisible=!1,a.globalPerTimeVisible=!1))},a.changeErrors=function(){0==a.usuarioElegido?alert("Please, select an user"):(a.errorsSelected=!a.errorsSelected,a.globalSelected=!1,a.globalPerProjectVisible=!1,a.globalPerTimeVisible=!1,0==a.errorsSelected&&(a.errorsPerProjectVisible=!1,a.errorsPerTimeVisible=!1),""==a.usuario&&alert("Please, select an user"))},a.globalPerProject=function(){a.globalPerProjectVisible=!0,a.globalPerTimeVisible=!1,r(),t()},a.globalPerTime=function(){a.globalPerProjectVisible=!1,a.globalPerTimeVisible=!0,o(),s()},a.errorsPerProject=function(){a.errorsPerProjectVisible=!0,a.errorsPerTimeVisible=!1,r(),p(),t()},a.errorsPerTime=function(){a.errorsPerProjectVisible=!1,a.errorsPerTimeVisible=!0,o(),q(),s()},a.openDatePickerFrom=function(b){b.preventDefault(),b.stopPropagation(),a.datePickerFromOpen=!0},a.openDatePickerUntil=function(b){b.preventDefault(),b.stopPropagation(),a.datePickerUntilOpen=!0},a.updateFromDate=function(){a.fromDate>a.untilDate&&(a.untilDate=new Date(a.fromDate)),a.userSelected(a.usuario)},a.updateUntilDate=function(){a.fromDate>a.untilDate&&(a.fromDate=new Date(a.untilDate)),a.userSelected(a.usuario)};var f=function(a,b){var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=1;a.length>20&&(d=Math.ceil(a.length/20));for(var e=0;e<a.length;e++)e%d==0?b.labels.push(c[a[e]._id.month-1]+" "+a[e]._id.day):b.labels.push("")},g=function(a,b){for(var c=0;c<a.length;c++)b.labels.push(a[c]._id)},h=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d].count);b.data.push(c)},i=function(){a.compileRunGraphByUser={labels:[],series:[],data:[]},d.get("/api/users/"+c.current.params.username+"/projects",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.allProjectObjects=b.ownerSet,a.allProjectObjects.sort(function(a,b){return a.id-b.id}),c.current.params.username!=a.usuario&&(a.compilerSummaryLogsByUser=z(a.compilerSummaryLogsByUser,a.allProjectObjects),a.compilerSummaryRunLogsByUser=z(a.compilerSummaryRunLogsByUser,a.allProjectObjects)),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryLogsByUser),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryRunLogsByUser),a.totalCompilationsDayByUserThroughTime="("+v(a.compilerSummaryLogsByUser,"count")+")",a.totalRunsDayByUserThroughTime="("+v(a.compilerSummaryRunLogsByUser,"count")+")",a.compileRunGraphByUser.series.push("Compilations"),h(a.compilerSummaryLogsByUser,a.compileRunGraphByUser),a.compileRunGraphByUser.series.push("Runs"),h(a.compilerSummaryRunLogsByUser,a.compileRunGraphByUser),f(a.compilerSummaryLogsByUser,a.compileRunGraphByUser)}).error(function(a){b.debug("Unable to get project names")})},j=function(){a.compileRunGraph={labels:[],series:[],data:[]},a.compilerSummaryLogsByUserPerProject.sort(function(a,b){return a._id-b._id}),a.compilerSummaryRunLogsByUserPerProject.sort(function(a,b){return a._id-b._id}),d.get("/api/users/"+c.current.params.username+"/projects",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.allProjectObjects=b.ownerSet,a.allProjectObjects.sort(function(a,b){return a.id-b.id}),c.current.params.username!=a.usuario&&(a.compilerSummaryLogsByUserPerProject=B(a.compilerSummaryLogsByUserPerProject,a.allProjectObjects),a.compilerSummaryRunLogsByUserPerProject=B(a.compilerSummaryRunLogsByUserPerProject,a.allProjectObjects)),a.compilerSummaryLogsByUserPerProject=C(a.compilerSummaryRunLogsByUserPerProject,a.compilerSummaryLogsByUserPerProject),a.compilerSummaryRunLogsByUserPerProject=C(a.compilerSummaryLogsByUserPerProject,a.compilerSummaryRunLogsByUserPerProject),a.totalCompilationsDayByUserPerProject="("+v(a.compilerSummaryLogsByUserPerProject,"count")+")",a.totalRunsDayByUserPerProject="("+v(a.compilerSummaryRunLogsByUserPerProject,"count")+")",a.compileRunGraph.series.push("Compilations"),h(a.compilerSummaryLogsByUserPerProject,a.compileRunGraph),a.compileRunGraph.series.push("Runs"),h(a.compilerSummaryRunLogsByUserPerProject,a.compileRunGraph),g(a.compilerSummaryLogsByUserPerProject,a.compileRunGraph)}).error(function(a){b.debug("Unable to get project names")})},k=function(){a.compileGraphDetail={labels:[],series:[],data:[]},a.runGraphDetail={labels:[],series:[],data:[]},a.compilerSummaryLogsByUserPerProjectDetail.sort(function(a,b){return a._id-b._id}),a.compilerSummaryRunLogsByUserPerProjectDetail.sort(function(a,b){return a._id-b._id}),d.get("/api/users/"+c.current.params.username+"/projects",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.allProjectObjects=b.ownerSet,a.allProjectObjects.sort(function(a,b){return a.id-b.id}),c.current.params.username!=a.usuario&&(a.compilerSummaryLogsByUserPerProjectDetail=B(a.compilerSummaryLogsByUserPerProjectDetail,a.allProjectObjects),a.compilerSummaryRunLogsByUserPerProjectDetail=B(a.compilerSummaryRunLogsByUserPerProjectDetail,a.allProjectObjects)),a.compilerSummaryLogsByUserPerProjectDetail=C(a.compilerSummaryRunLogsByUserPerProjectDetail,a.compilerSummaryLogsByUserPerProjectDetail),a.compilerSummaryRunLogsByUserPerProjectDetail=C(a.compilerSummaryLogsByUserPerProjectDetail,a.compilerSummaryRunLogsByUserPerProjectDetail),a.totalCompilationsDayByUserPerProjectDetail="("+v(a.compilerSummaryLogsByUserPerProjectDetail,"count")+")",a.totalRunsDayByUserPerProjectDetail="("+v(a.compilerSummaryRunLogsByUserPerProjectDetail,"count")+")",a.totalCompilationsDayByUserPerProjectError="("+v(a.compilerSummaryLogsByUserPerProject.filter(function(b){return a.compilerSummaryLogsByUserPerProjectDetail.map(function(a){return a._id}).indexOf(b._id)!==-1}),"count")+")",a.totalRunsDayByUserPerProjectError="("+v(a.compilerSummaryRunLogsByUserPerProject.filter(function(b){return a.compilerSummaryRunLogsByUserPerProjectDetail.map(function(a){return a._id}).indexOf(b._id)!==-1}),"count")+")",a.compileGraphDetail.series.push("Compilations"),h(a.compilerSummaryLogsByUserPerProject.filter(function(b){return a.compilerSummaryLogsByUserPerProjectDetail.map(function(a){return a._id}).indexOf(b._id)!==-1}),a.compileGraphDetail),a.compileGraphDetail.series.push("Erroneous Compilations"),h(a.compilerSummaryLogsByUserPerProjectDetail,a.compileGraphDetail),g(a.compilerSummaryLogsByUserPerProjectDetail,a.compileGraphDetail),a.runGraphDetail.series.push("Runs"),h(a.compilerSummaryRunLogsByUserPerProject.filter(function(b){return a.compilerSummaryRunLogsByUserPerProjectDetail.map(function(a){return a._id}).indexOf(b._id)!==-1}),a.runGraphDetail),a.runGraphDetail.series.push("Erroneous Executions"),h(a.compilerSummaryRunLogsByUserPerProjectDetail,a.runGraphDetail),g(a.compilerSummaryRunLogsByUserPerProjectDetail,a.runGraphDetail)}).error(function(a){b.debug("Unable to get project names")})},l=function(){a.compileGraphDetailTime={labels:[],series:[],data:[]},a.runGraphDetailTime={labels:[],series:[],data:[]},e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryLogsByUserPerTimeDetail),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryRunLogsByUserPerTimeDetail),d.get("/api/users/"+c.current.params.username+"/projects",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.allProjectObjects=b.ownerSet,a.allProjectObjects.sort(function(a,b){return a.id-b.id}),c.current.params.username!=a.usuario&&(a.compilerSummaryLogsByUserPerTimeDetail=z(a.compilerSummaryLogsByUserPerTimeDetail,a.allProjectObjects),a.compilerSummaryRunLogsByUserPerTimeDetail=z(a.compilerSummaryRunLogsByUserPerTimeDetail,a.allProjectObjects)),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryLogsByUserPerTimeDetail),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryRunLogsByUserPerTimeDetail),a.totalCompilationsDayByUserPerTimetDetail="("+v(a.compilerSummaryLogsByUserPerTimeDetail,"count")+")",a.totalRunsDayByUserPerTimeDetail="("+v(a.compilerSummaryRunLogsByUserPerTimeDetail,"count")+")",a.compilerSummaryLogsByUser=A(a.compilerSummaryLogsByUser,a.compilerSummaryLogsByUserPerTimeDetail),a.totalCompilationsDayByUserPerTimeError="("+v(a.compilerSummaryLogsByUser,"count")+")",a.totalRunsDayByUserPerTimeError="("+v(a.compilerSummaryRunLogsByUser,"count")+")",a.compilerSummaryRunLogsByUser=A(a.compilerSummaryRunLogsByUser,a.compilerSummaryRunLogsByUserPerTimeDetail),a.totalRunsDayByUserPerTimeError="("+v(a.compilerSummaryRunLogsByUser,"count")+")",a.compileGraphDetailTime.series.push("Compilations"),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryLogsByUser),h(a.compilerSummaryLogsByUser,a.compileGraphDetailTime),a.compileGraphDetailTime.series.push("Erroneous Compilations"),h(a.compilerSummaryLogsByUserPerTimeDetail,a.compileGraphDetailTime),f(a.compilerSummaryLogsByUserPerTimeDetail,a.compileGraphDetailTime),a.runGraphDetailTime.series.push("Runs"),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryRunLogsByUser),h(a.compilerSummaryRunLogsByUser,a.runGraphDetailTime),a.runGraphDetailTime.series.push("Erroneous Executions"),h(a.compilerSummaryRunLogsByUserPerTimeDetail,a.runGraphDetailTime),f(a.compilerSummaryRunLogsByUserPerTimeDetail,a.runGraphDetailTime)}).error(function(a){b.debug("Unable to get project names")})},m=function(){a.dataGraphUserAccess={labels:[],series:[],data:[]},d.get("/api/users/"+c.current.params.username+"/projects",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.allProjectObjects=b.ownerSet,a.allProjectObjects.sort(function(a,b){return a.id-b.id}),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.projectAccessPerDay),c.current.params.username!=a.usuario&&(a.projectAccessPerDay=z(a.projectAccessPerDay,a.allProjectObjects)),a.totalAccessPerDayTime="("+v(a.projectAccessPerDay,"count")+")",a.dataGraphUserAccess.series.push("Project accesses"),h(a.projectAccessPerDay,a.dataGraphUserAccess),f(a.projectAccessPerDay,a.dataGraphUserAccess)}).error(function(a){b.debug("Unable to get project names")})},n=function(){a.dataGraphUserAccessPerProject={labels:[],series:[],data:[]},a.projectAccessPerDayPerProject.sort(function(a,b){return a._id-b._id}),d.get("/api/users/"+c.current.params.username+"/projects",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.allProjectObjects=b.ownerSet,a.allProjectObjects.sort(function(a,b){return a.id-b.id}),c.current.params.username!=a.usuario&&(a.projectAccessPerDayPerProject=B(a.projectAccessPerDayPerProject,a.allProjectObjects)),a.totalAccessPerDayPerProject="("+v(a.projectAccessPerDayPerProject,"count")+")",a.dataGraphUserAccessPerProject.series.push("Project accesses"),h(a.projectAccessPerDayPerProject,a.dataGraphUserAccessPerProject),g(a.projectAccessPerDayPerProject,a.dataGraphUserAccessPerProject)}).error(function(a){b.debug("Unable to get project names")})},o=function(){a.isLoadingCompilationRunGraphData=!0,d.get("/api/log/user/getCompilationRunDataForGraphByUser/",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.compilerSummaryLogsByUser=b.compilerLogs,a.compilerSummaryRunLogsByUser=b.compilerRunLogs,i(),a.isLoadingCompilationRunGraphData=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics (summary per day).")})},p=function(){a.isLoadingCompilationRunGraphDataDetail=!0,d.get("/api/log/user/getCompilationRunDataDetailPerProjectForGraph/",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.compilerSummaryLogsByUserPerProjectDetail=b.compilerLogs,a.compilerSummaryRunLogsByUserPerProjectDetail=b.compilerRunLogs,k(),a.isLoadingCompilationRunGraphDataDetail=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics (summary per day).")})},q=function(){a.isLoadingCompilationRunGraphDataDetailTime=!0,d.get("/api/log/user/getCompilationRunDataDetailPerTimeForGraph/",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.compilerSummaryLogsByUserPerTimeDetail=b.compilerLogs,a.compilerSummaryRunLogsByUserPerTimeDetail=b.compilerRunLogs,l(),a.isLoadingCompilationRunGraphDataDetailTime=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics (summary per day).")})},r=function(){a.isLoadingCompilationRunGraphData=!0,d.get("/api/log/user/getCompilationRunDataPerProjectForGraphByUser/",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.compilerSummaryLogsByUserPerProject=b.compilerLogs,a.compilerSummaryRunLogsByUserPerProject=b.compilerRunLogs,j(),a.isLoadingCompilationRunGraphData=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics (summary per day).")})},s=function(){a.isLoadingUserAccessGraphData=!0;c.current.params.projectId;d.get("/api/log/user/summaryProjectAccessDayByUser/",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.projectAccessPerDay=b.projectAccessPerDay,m(),a.isLoadingUserAccessGraphData=!1}).error(function(a){})};a.hideShowCompilationRunDetail=function(){a.compilationRunTableVisibleDetail=!a.compilationRunTableVisibleDetail,a.compilationRunTableVisibleDetail?(a.compilationRunBtnLabelGraph="Hide compilation details",p()):a.compilationRunBtnLabelGraph="Show compilation details"};var t=function(){a.isLoadingUserAccessGraphData=!0;c.current.params.projectId;d.get("/api/log/user/summaryProjectAccessDayPerProject/",{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.projectAccessPerDayPerProject=b.projectAccessPerDay,n(),a.isLoadingUserAccessGraphData=!1}).error(function(a){})};a.hideShowCompilationRunTable=function(){a.compilationRunTableVisible=!a.compilationRunTableVisible,a.compilationRunTableVisible?(a.compilationRunBtnLabel="Hide compilation details",q()):a.compilationRunBtnLabel="Show compilation details"},a.hideShowProjectAccessDetails=function(){a.projectAccessTableVisible=!a.projectAccessTableVisible,a.projectAccessTableVisible?(a.projectAccessBtnLabel="Hide user details",w()):a.projectAccessBtnLabel="Show user details"},a.hideShowSubmissionsDetails=function(){a.submissionTableVisible=!a.submissionTableVisible,a.submissionTableVisible?(a.submissionBtnLabel="Hide user details",x()):a.submissionBtnLabel="Show user details"},a.currentPageProjectAccess=0,a.currentPageCompilations=0,a.currentPageRuns=0,a.currentPageSubmissions=0,a.numPerPage=10,a.maxSizePage=10,a.filteredProjAccesses=[],a.filteredCompilations=[],a.filteredRuns=[],a.filteredSubmissions=[],a.pageChanged=function(b,c){var d=(b-1)*a.numPerPage,e=d+a.numPerPage;return void 0!=c?c.slice(d,e):[]},a.pageCompilationChanged=function(){a.filteredCompilations=a.pageChanged(a.currentPageCompilations,a.compilationStats)},a.pageRunsChanged=function(){a.filteredRuns=a.pageChanged(a.currentPageRuns,a.runStats)},a.pageProjectAccessChanged=function(){a.filteredProjAccesses=a.pageChanged(a.currentPageProjectAccess,a.accessStats)},a.pageSubmissionsChanged=function(){a.filteredSubmissions=a.pageChanged(a.currentPageSubmissions,a.submissionStats)};var u=function(a){a.sort(function(a,b){return a._id<b._id?-1:a._id>b._id?1:0})},v=function(a,b){for(var c=0,d=0;d<a.length;d++)c+=a[d][b];return c},w=function(){a.isLoadingProjectAccessDetails=!0;c.current.params.projectId;d.get("/api/log/user/summaryProjectAccess2/",{params:{startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.accessStats=b.projectAccess,a.totalAccesses=v(a.accessStats,"countProjectAccess"),u(a.accessStats),a.currentPageProjectAccess=1,a.pageProjectAccessChanged(),a.isLoadingProjectAccessDetails=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics.")})},x=function(){a.isLoadingSubmissionsDetails=!0;var e=c.current.params.projectId;d.get("/api/log/user/summarySubmitAccess/"+e,{params:{startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.submissionStats=b.submitLogs,a.totalSubmissions=v(a.submissionStats,"countProjectAccess"),u(a.submissionStats),a.currentPageSubmissions=1,a.pageSubmissionsChanged(),a.isLoadingSubmissionsDetails=!1}).error(function(a){b.debug("Unable to get submission statistics.")})},y=function(){a.fromDate&&a.untilDate&&(a.isLoadingCompilationRunGraphData&&p(),a.projectAccessTableVisible&&w(),a.submissionTableVisible&&x())};a.loadUsers=function(){w()},a.userSelected=function(b){a.usuarioElegido=!0,void 0!=b._id&&(a.allProjectObjects=void 0,a.usuario=b._id),o(),s(),r(),t(),a.isLoadingCompilationRunGraphDataDetail||p(),a.isLoadingCompilationRunGraphDataTime||q()},a.usuario="",y(),a.update=function(){""!=a.usuario&&a.userSelected(a.usuario)};var z=function(a,b){var c=!1,d=!1,e=JSON.parse(JSON.stringify(a)),f=0,g=0,h=0,i=0;for(h=0;h<e.length;h++)if(void 0!=a[h].projectId){var j=a[h].projectId.slice(0),k=0;for(i=0;i<j.length;i++){for(g=0;g<b.length;g++)if(a.length>f&&a[h].projectId[k]==b[g].id){c=!0,k++,d=!0;break}0==d&&(a[h].projectId.splice(k,1),a[h].count--),d=!1}c=!1}return a},A=function(a,b){var c=!1,d=!1,e=JSON.parse(JSON.stringify(a)),f=0,g=0,h=0,i=0,j=0;for(h=0;h<e.length;h++)if(void 0!=a[h].projectId){var k=a[h].projectId.slice(0),l=0;for(i=0;i<k.length;i++){for(g=0;g<b.length;g++)if(a.length>f&&void 0!=b[g].projectId){for(j=0;j<b[g].projectId.length;j++)if(a[h].projectId[l]==b[g].projectId[j]){c=!0,l++,d=!0;break}if(d)break}0==d&&(a[h].projectId.splice(l,1),a[h].count--),d=!1}c=!1}return a},B=function(a,b){var c=!1,d=JSON.parse(JSON.stringify(a)),e=0,f=0,g=0;for(g=0;g<d.length;g++){for(f=0;f<b.length;f++)a.length>e&&a[e]._id==b[f].id&&(c=!0,a[e]._id=b[f].projectname,e++);0==c&&a.splice(e,1),c=!1}return a},C=function(a,b){for(var c=JSON.parse(JSON.stringify(a)),d=JSON.parse(JSON.stringify(b)),e=!1,f=0;f<a.length;f++){for(var g=0;g<b.length;g++)if(c[f]._id==d[g]._id){e=!0;break}0==e&&(d.push(c.slice(f,f+1)[0]),d[d.length-1].count=0),e=!1}return d.sort(function(a,b){if(void 0==a.projectname)var a=a._id-b._id;else var a=D(a._id)-D(b._id);return a})},D=function(b){var c;return c=a.allProjectObjects[a.allProjectObjects.map(function(a){return a.projectname}).indexOf(b)].id};a.myFilter=function(b){return b._id.startsWith(a.usuario)}}]),angular.module("codeboardApp").controller("projectsAllCtrl",["$scope","$http",function(a,b){a.data={count:0,projects:[],hasNext:!1,next:"/api/projects"},a.featuredData={projects:[]},a.searchString="",a.searchTerms=[];(function(){b.get("/api/projects").success(function(b,c){a.data=b}).error(function(a){}),b.get("/api/projects/featured").success(function(b,c){a.featuredData=b}).error(function(a){})})();a.submitSearch=function(c){var d=c.trim();d=d.replace(/\s+/g," "),b.get("/api/projects?search="+encodeURIComponent(d)).success(function(b,c){a.data.count=b.count,a.data.projects=b.projects,a.data.hasNext=b.hasNext,a.data.next=b.next}).error(function(b){"422"===b.status&&""!==d&&(a.data.count=0,a.data.projects=[],a.data.hasNext=!1,a.data.next="/api/projects",a.searchTerms=b.searchTerms)})},a.showMore=function(){a.data.hasNext&&b.get(a.data.next).success(function(b,c){a.data.projects=a.data.projects.concat(b.projects),a.data.hasNext=b.hasNext,a.data.next=b.next}).error(function(a,b){})},a.display={search:!0,featured:!1},a.setDisplay=function(b){"search"===b&&(a.display.search=!0,a.display.featured=!1),"featured"===b&&(a.display.search=!1,a.display.featured=!0)}}]),angular.module("codeboardApp").controller("ProjectSettingsCtrl",["$scope","$http","$log","$routeParams","$location","$timeout","$uibModal","ProjectRes","projectData",function(a,b,c,d,e,f,g,h,i){a.data={},a.originalData={},a.projectId=d.projectId,a.server={saveSuccess:!1,saveFailure:!1},a.init=function(){angular.copy(i,a.originalData),a.data=i,a.data.ownerSet||(a.data.ownerSet=[]),a.data.userSet||(a.data.userSet=[])}(),a.addOwners=function(b){a.data.ownerSet=j(a.data.ownerSet,b),a.input.newOwner=""},a.addUsers=function(b){a.data.userSet=j(a.data.userSet,b),a.input.newUser=""};var j=function(a,b){for(var c=b.split(","),d=[],e=0;e<c.length;e++){var f=c[e].trim();f.length>0&&d.push({username:c[e].trim()})}var g=function(a,b){return a.username<b.username?-1:a.username>b.username?1:0};return a.concat(d).sort(g)};a.removeMember=function(a,b){var c=-1;for(var d in a)a[d].username===b&&(c=d);a.splice(c,1)},a.discardChanges=function(){angular.copy(a.originalData,a.data)},a.save=function(c){var e=d.projectId;if(c.$valid){var g={projectname:a.data.projectname,description:a.data.description,language:a.data.language,isPrivate:a.data.isPrivate,ownerSet:[],userSet:[],isSubmissionAllowed:a.data.isSubmissionAllowed,isLtiAllowed:a.data.isLtiAllowed,ltiKey:a.data.ltiKey,ltiSecret:a.data.ltiSecret};for(var h in a.data.ownerSet)g.ownerSet.push(a.data.ownerSet[h].username);for(var h in a.data.userSet)g.userSet.push(a.data.userSet[h].username);a.server.saveSuccess=!1,a.server.saveFailure=!1,b.put("/api/projects/"+e+"/settings",g).success(function(b,c,d,e){a.server.saveSuccess=!0,f(function(){a.server.saveSuccess=!1},4e3)}).error(function(b,c,d,e){a.server.saveFailure=!0})}};var k=function(){h.remove({projectId:d.projectId},function(a){c.debug("Deletion ok"),e.url("/")},function(a){c.debug("Deletion failed")})},l=["$scope","$uibModalInstance",function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}];a.openDeletionModal=function(){var a=g.open({templateUrl:"DeletionModalContent.html",controller:l});a.result.then(function(){c.debug("User confirmed deletion of project."),k()},function(){c.debug("User canceled deletion of project.")})}}]),angular.module("codeboardApp").controller("ProjectSummaryCtrl",["$scope","$http","$log","$routeParams","$location","projectSummaryData","UserSrv",function(a,b,c,d,e,f,g){a.prj=f,a.isCurrentUserProjectOwner=function(){return g.isAuthenticated()&&f.ownerSet.some(function(a,b,c){return a.username===g.getUsername()})}}]),angular.module("codeboardApp").controller("ProjectNewCtrl",["$scope","$http","$routeParams","$location","$route","$timeout",function(a,b,c,d,e,f){a.data={language:"Java-JUnit"},a.server={saveSuccess:!1,saveFailure:!1},a.save=function(e){c.projectId;if(e.$valid){var f={projectname:a.data.projectname,description:a.data.description,language:a.data.language,isPrivate:a.data.isPrivate};a.server.saveSuccess=!1,a.server.saveFailure=!1,b.post("/api/projects/",f).success(function(b,c,e,f){a.server.saveSuccess=!0,d.path("/projects/"+b.id+"/summary")}).error(function(b,c,d,e){a.server.saveFailure=!0})}}}]),angular.module("codeboardApp").controller("ProjectStatsCtrl",["$scope","$log","$route","$http","StatsSrv",function(a,b,c,d,e){a.fromDate=new Date,a.fromDate.setMonth(a.fromDate.getMonth()-1),a.untilDate=new Date,a.datePickerMaxSelectableDate=new Date,a.datePickerDateFormat="dd-MMMM-yyyy",a.datePickerFromOpen=!1,a.datePickerUntilOpen=!1,a.projectId=c.current.params.projectId,a.isLoadingCompilationRunGraphData=!0,a.isLoadingUserAccessGraphData=!0,a.isLoadingUserAccessGraphDataByUser=!0,a.compilationRunTableVisible=!1,a.projectAccessTableVisible=!1,a.submissionTableVisible=!1,a.isLoadingCompilationRunDetails=!1,a.isLoadingProjectAccessDetails=!1,a.isLoadingSubmissionsDetails=!1,a.compilationRunBtnLabel="Show user details",a.projectAccessBtnLabel="Show user details",a.submissionBtnLabel="Show user details",a.usuarioVisible=!1,a.openDatePickerFrom=function(b){b.preventDefault(),b.stopPropagation(),a.datePickerFromOpen=!0},a.openDatePickerUntil=function(b){b.preventDefault(),b.stopPropagation(),a.datePickerUntilOpen=!0},a.updateFromDate=function(){a.fromDate>a.untilDate&&(a.untilDate=new Date(a.fromDate)),u()},a.updateUntilDate=function(){a.fromDate>a.untilDate&&(a.fromDate=new Date(a.untilDate)),u()};var f=function(a,b){var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=1;a.length>20&&(d=Math.ceil(a.length/20));for(var e=0;e<a.length;e++)e%d==0?b.labels.push(c[a[e]._id.month-1]+" "+a[e]._id.day):b.labels.push("")},g=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d].count);b.data.push(c)},h=function(){a.compileRunGraph={labels:[],series:[],data:[]},e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryLogs),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryRunLogs),a.compileRunGraph.series.push("Compilations"),g(a.compilerSummaryLogs,a.compileRunGraph),a.compileRunGraph.series.push("Runs"),g(a.compilerSummaryRunLogs,a.compileRunGraph),f(a.compilerSummaryLogs,a.compileRunGraph)},i=function(){a.compileRunGraphByUser={labels:[],series:[],data:[]},e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryLogsByUser),e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.compilerSummaryRunLogsByUser),a.compileRunGraphByUser.series.push("Compilations"),g(a.compilerSummaryLogsByUser,a.compileRunGraphByUser),a.compileRunGraphByUser.series.push("Runs"),g(a.compilerSummaryRunLogsByUser,a.compileRunGraphByUser),f(a.compilerSummaryLogsByUser,a.compileRunGraphByUser)},j=function(){a.dataGraphUserAccess={labels:[],series:[],data:[]},e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.projectAccessPerDay),a.dataGraphUserAccess.series.push("Project accesses"),g(a.projectAccessPerDay,a.dataGraphUserAccess),f(a.projectAccessPerDay,a.dataGraphUserAccess)},k=function(){a.dataGraphUserAccessByUser={labels:[],series:[],data:[]},e.sortAndAddMissingDates(a.fromDate,a.untilDate,a.projectAccessPerDayByUser),a.dataGraphUserAccessByUser.series.push("Project accesses"),g(a.projectAccessPerDayByUser,a.dataGraphUserAccessByUser),f(a.projectAccessPerDayByUser,a.dataGraphUserAccessByUser)},l=function(){a.isLoadingCompilationRunGraphData=!0;var e=c.current.params.projectId;d.get("/api/log/user/summaryProjectCompilationRunDay/"+e,{params:{startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.compilerSummaryLogs=b.compilerLogs,a.compilerSummaryRunLogs=b.compilerRunLogs,a.totalCompilationsDay="("+q(a.compilerSummaryLogs,"count")+")",a.totalRunsDay="("+q(a.compilerSummaryRunLogs,"count")+")",a.total,h(),a.isLoadingCompilationRunGraphData=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics (summary per day).")})},m=function(){a.isLoadingCompilationRunGraphData=!0;var e=c.current.params.projectId;d.get("/api/log/user/summaryProjectCompilationRunDayByUser/"+e,{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.compilerSummaryLogsByUser=b.compilerLogs,a.compilerSummaryRunLogsByUser=b.compilerRunLogs,a.totalCompilationsDayByUser="("+q(a.compilerSummaryLogsByUser,"count")+")",a.totalRunsDayByUser="("+q(a.compilerSummaryRunLogsByUser,"count")+")",i(),a.isLoadingCompilationRunGraphData=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics (summary per day).")})},n=function(){a.isLoadingUserAccessGraphData=!0;var b=c.current.params.projectId;d.get("/api/log/user/summaryProjectAccessDay/"+b,{params:{startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.projectAccessPerDay=b.projectAccessPerDay,a.totalAccessPerDay="("+q(a.projectAccessPerDay,"count")+")",j(),a.isLoadingUserAccessGraphData=!1}).error(function(a){})},o=function(){a.isLoadingUserAccessGraphDataByUser=!0;var b=c.current.params.projectId;d.get("/api/log/user/summaryProjectAccessDayByUser/"+b,{params:{user:a.usuario,startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.projectAccessPerDayByUser=b.projectAccessPerDay,a.totalAccessPerDayByUser="("+q(a.projectAccessPerDayByUser,"count")+")",k(),a.isLoadingUserAccessGraphDataByUser=!1}).error(function(a){})};a.hideShowCompilationRunTable=function(){a.compilationRunTableVisible=!a.compilationRunTableVisible,a.compilationRunTableVisible?(a.compilationRunBtnLabel="Hide user details",r()):a.compilationRunBtnLabel="Show user details"},a.hideShowProjectAccessDetails=function(){a.projectAccessTableVisible=!a.projectAccessTableVisible,a.projectAccessTableVisible?(a.projectAccessBtnLabel="Hide user details",s()):a.projectAccessBtnLabel="Show user details"},a.hideShowSubmissionsDetails=function(){a.submissionTableVisible=!a.submissionTableVisible,a.submissionTableVisible?(a.submissionBtnLabel="Hide user details",t()):a.submissionBtnLabel="Show user details"},a.currentPageProjectAccess=0,a.currentPageCompilations=0,a.currentPageRuns=0,a.currentPageSubmissions=0,a.numPerPage=10,a.maxSizePage=10,a.filteredProjAccesses=[],a.filteredCompilations=[],a.filteredRuns=[],a.filteredSubmissions=[],a.pageChanged=function(b,c){var d=(b-1)*a.numPerPage,e=d+a.numPerPage;return void 0!=c?c.slice(d,e):[]},a.pageCompilationChanged=function(){a.filteredCompilations=a.pageChanged(a.currentPageCompilations,a.compilationStats)},a.pageRunsChanged=function(){a.filteredRuns=a.pageChanged(a.currentPageRuns,a.runStats)},a.pageProjectAccessChanged=function(){a.filteredProjAccesses=a.pageChanged(a.currentPageProjectAccess,a.accessStats)},a.pageSubmissionsChanged=function(){a.filteredSubmissions=a.pageChanged(a.currentPageSubmissions,a.submissionStats);
};var p=function(a){a.sort(function(a,b){return a._id<b._id?-1:a._id>b._id?1:0})},q=function(a,b){for(var c=0,d=0;d<a.length;d++)c+=a[d][b];return c},r=function(){a.isLoadingCompilationRunDetails=!0;var e=c.current.params.projectId;d.get("/api/log/user/summaryCompiler/"+e,{params:{startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.compilationStats=b.compilerLogs,a.runStats=b.compilerRunLogs,a.totalCompilations=q(a.compilationStats,"countProjectAccess"),a.totalRuns=q(a.runStats,"countProjectAccess"),p(a.compilationStats),p(a.runStats),a.currentPageCompilations=1,a.pageCompilationChanged(),a.currentPageRuns=1,a.pageRunsChanged(),a.isLoadingCompilationRunDetails=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics.")})},s=function(){a.isLoadingProjectAccessDetails=!0;var e=c.current.params.projectId;d.get("/api/log/user/summaryProjectAccess/"+e,{params:{startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.accessStats=b.projectAccess,a.totalAccesses=q(a.accessStats,"countProjectAccess"),p(a.accessStats),a.currentPageProjectAccess=1,a.pageProjectAccessChanged(),a.isLoadingProjectAccessDetails=!1}).error(function(a){b.debug("Unable to get compile and run logs statistics.")})},t=function(){a.isLoadingSubmissionsDetails=!0;var e=c.current.params.projectId;d.get("/api/log/user/summarySubmitAccess/"+e,{params:{startDateLogs:a.fromDate,endDateLogs:a.untilDate}}).success(function(b){a.submissionStats=b.submitLogs,a.totalSubmissions=q(a.submissionStats,"countProjectAccess"),p(a.submissionStats),a.currentPageSubmissions=1,a.pageSubmissionsChanged(),a.isLoadingSubmissionsDetails=!1}).error(function(a){b.debug("Unable to get submission statistics.")})},u=function(){a.fromDate&&a.untilDate&&(l(),n(),a.compilationRunTableVisible&&r(),a.projectAccessTableVisible&&s(),a.submissionTableVisible&&t())};a.loadUsers=function(){s()},a.userSelected=function(b){a.usuarioVisible=!0,a.usuario=b._id,m(),o()},a.usuario="",u(),a.update=function(){a.usuarioVisible=!1},a.myFilter=function(b){return b._id.startsWith(a.usuario)}}]),angular.module("codeboardApp").controller("ProjectSubmissionsCtrl",["$scope","$log","$routeParams","$http",function(a,b,c,d){a.usernameFilter=void 0,a.projectId=c.projectId,a.submissionData=[];(function(){var e=c.projectId;d.get("/api/projects/"+e+"/submissions").success(function(b,c,d,e){a.submissionData=b}).error(function(a,c,d,e){b.debug("Can not get the submissions")})})()}]),angular.module("codeboardApp").controller("ProjectUserProjectsCtrl",["$scope","$log","$routeParams","$http",function(a,b,c,d){a.usernameFilter=void 0,a.projectId=c.projectId,a.userProjects=[];(function(){var e=c.projectId;d.get("/api/projects/"+e+"/userprojects").success(function(b,c,d,e){a.userProjects=b}).error(function(a,c,d,e){b.debug("Can not get the userprojects")})})()}]),angular.module("codeboardApp").controller("SupportCtrl",["$scope","$rootScope","$http","$routeParams","$location",function(a,b,c,d,e){a.data={reqBody:"",outcomeServiceUrl:"",sourcedId:"",responseHeader:"",responseBody:"",responseStatusCode:0};(function(){var b=JSON.parse(decodeURIComponent(d.reqBody)),c="";for(var e in b)c=c+e+"="+b[e]+"\n";a.data.reqBody=c,a.data.outcomeServiceUrl=b.lis_outcome_service_url,a.data.sourcedId=b.lis_result_sourcedid})();a.sendGrade=function(b){var d={grade:b,lis_outcome_service_url:a.data.outcomeServiceUrl,lis_result_sourcedid:a.data.sourcedId};c.put("/support/lti/debug/outcome",d).success(function(b,c,d,e){a.data.responseStatusCode=b.statusCode,a.data.responseHeader=b.headers,a.data.responseBody=b.body}).error(function(a,b,c,d){})}}]);var services=angular.module("codeboardApp");services.factory("ProjectFactory",["$http","$routeParams","$q","$log","ProjectRes","ProjectSubmissionRes",function(a,b,c,d,e,f){var g={},h=function(){return g},i=function(a){g=a},j="",k="",l=function(){k=m()},m=function(){for(var a=D(h().files),b=[],c=0;c<a.length;c++){var d={filename:a[c].filename,path:a[c].path,uniqueUId:a[c].uniqueUId,parentUId:a[c].parentUId,isFolder:a[c].isFolder,content:a[c].content};b.push(d)}var e=new jsSHA(angular.toJson(b),"TEXT");return e.getHash("SHA-256","HEX")},n=function(){var a=m();return a!==k},o=function(a,b,c,d,e){var f={};return f.id=e.id||-1,f.filename=a,f.path=b,f.uniqueId=c,f.parentUId=d,f.isFolder=e.isFolder||!1,f.content=e.content||"",f.isHidden=e.isHidden||!1,f.isFolder&&(f.children=[]),f.isFolder||(f.session=null),f.filename_annotated=f.filename+s(f),f},p=function(a){if("string"!=typeof a){var b=h().idToNodeMap[a];return b?b:null}if("s"===a.charAt(0)){var c=a.substring(1);h().staticFiles[c].url;return h().staticFiles[c].content||(h().staticFiles[c].content="-- Fetching file content. Please wait...",h().staticFiles[c].isContentSet=!1),h().staticFiles[c]}},q=function(a){return!!h().idToNodeMap[a]},r=function(a){a.isHidden=!a.isHidden,a.filename_annotated=a.filename+s(a)},s=function(a){var b="";return a.isHidden&&(b+=" (",a.isHidden&&(b+="h"),b+=")"),b},t=function(a,b){return a>b?1:a<b?-1:0},u=function(a,b){return a.isFolder&&!b.isFolder?-1:!a.isFolder&&b.isFolder?1:a.isFolder&&b.isFolder?t(a.filename,b.filename):a.isFolder||b.isFolder?0:t(a.filename,b.filename)},v=function(a,b){var c=h().idToNodeMap[a];if(c.isFolder){var d=o(b.filename,b.path,b.uniqueId,b.parentUId,{isFolder:b.isFolder,id:b.id,content:b.content,isHidden:b.isHidden});return h().idToNodeMap[d.uniqueId]=d,c.children.push(d),c.children.sort(u),d}return null},w=function(a,b,c){var d=a,e=h().idToNodeMap[a];if(e.isFolder||(e=h().idToNodeMap[e.parentUId],d=e.uniqueId),e.isFolder){h().lastUId+=1;var f=""===e.path?"":e.path+"/",g=o(b,f+p(d).filename,h().lastUId,d,{isFolder:c});return h().idToNodeMap[g.uniqueId]=g,e.children.push(g),e.children.sort(u),g}return null},x=function(a,b){return w(a,b,!1)},y=function(a,b){return w(a,b,!0)},z=function(a,b){var c=function(a,b){if(a.path=b,a.children)for(var d=0;d<a.children.length;d++)c(a.children[d],a.path+"/"+a.filename)},d=h().idToNodeMap[a];d&&(d.filename=b,d.filename_annotated=b+s(d),d.isFolder&&c(d,d.path),j="")},A=function(a,b){if(void 0!==h().idToNodeMap[a]&&0!==h().idToNodeMap[a].uniqueId&&(!h().idToNodeMap[a].isFolder||0===h().idToNodeMap[a].children.length||b===!0)){var c=h().idToNodeMap[a],d=h().idToNodeMap[c.parentUId],e=d.children.indexOf(c);d.children.splice(e,1),delete h().idToNodeMap[a],j=""}},B=function(a,b,c){var d={},e=[];j="","[object Object]"===Object.prototype.toString.call(arguments[1])?d=arguments[1]:"[object Array]"===Object.prototype.toString.call(arguments[1])&&(e=arguments[1]),"[object Array]"===Object.prototype.toString.call(arguments[2])&&(e=c);var f={name:a.projectname,lastUId:a.lastUId,files:[],idToNodeMap:[],language:a.language,ltiData:{},userRole:a.userRole,userBeingInspected:a.username?a.username:null,staticFiles:e};i(f),C(d);var g=a.fileSet;g.sort(function(a,b){return a.parentUId<b.parentUId?-1:a.parentUId>b.parentUId?1:0});var k=o(g[0].filename,g[0].path,g[0].uniqueId,g[0].parentUId,{content:g[0].content,isFolder:g[0].isFolder,id:g[0].id,isHidden:g[0].isHidden});h().files.push(k),h().idToNodeMap[h().files[0].uniqueId]=h().files[0];for(var m=1;m<g.length;m++)v(g[m].parentUId,g[m]);l()},C=function(a){a.ltiSessionId&&a.ltiUserId&&a.ltiNonce?(h().ltiData=a,h().hasLtiData=!0):h().hasLtiData=!1},D=function(a){var b=[];for(var c in a){var d=[{filename:a[c].filename,path:a[c].path,content:a[c].content,uniqueId:a[c].uniqueId,parentUId:a[c].parentUId,isFolder:a[c].isFolder,id:a[c].id,isHidden:a[c].isHidden}];b=a[c].children?b.concat(D(a[c].children),d):b.concat(d)}return b},E=function(){var a={project:{lastUId:h().lastUId},files:D(h().files)};h().hasLtiData&&(a.hasLtiData=h().hasLtiData,a.ltiData=h().ltiData);var d=c.defer();return e.update({projectId:b.projectId},a,function(a,b,c,e){l(),d.resolve(!0)},function(a,b,c,e){d.reject(!1)}),d.promise},F=function(a){var b=D(h().files),c={},d=[];for(var e in b)if(!b[e].isFolder){var f=b[e].path+"/"+b[e].filename,g={filename:f,content:b[e].content};d.push(g)}return c.files=d,c.language=h().language,c.action="compile",""===j||a||(c.id=j),c.hasLtiData=h().hasLtiData,c.ltiData=h().ltiData,c},G=function(a){var d=F(a),f=c.defer();return e.save({projectId:b.projectId},d,function(a,b,c,d){j=a.id,f.resolve(a)},function(a){j="";var b="\n-- Error details --";a.status&&a.data&&a.data.msg?(b+="\nStatus code: "+a.status,b+="\nError message: "+a.data.msg):b+="\n"+JSON.stringify(a),f.reject(b)}),f.promise},H=function(){var a={};a.language=h().language,a.action="run",a.id=j,a.hasLtiData=h().hasLtiData,a.ltiData=h().ltiData;var d=c.defer();return e.save({projectId:b.projectId},a,function(a,b){d.resolve(a)},function(a){j="";var b="\n-- Error details --";a.status&&a.data&&a.data.msg?(b+="\nStatus code: "+a.status,b+="\nError message: "+a.data.msg):b+="\n"+JSON.stringify(a),d.reject(b)}),d.promise},I=function(){var a=F(!0);a.action="test";var d=c.defer();return e.save({projectId:b.projectId},a,function(a,b,c,e){j=a.id,d.resolve(a)},function(a){j="";var b="\n-- Error details --";b+="\nStatus text: ",b+=a.statusText?a.statusText:"not available",b+="\nStatus code: ",b+=a.status?a.status:"not available",b+="\nError no: ",b+=a.data&&a.data.cause&&a.data.cause.errno?a.data.cause.errno:"not available",b+="\nError output: ",b+=a.data&&a.data.output?a.data.output:"not available",d.reject(b)}),d.promise},J=function(){var a=F(!0);a.action="tool";var d=c.defer();return e.save({projectId:b.projectId},a,function(a,b,c,e){d.resolve(a)},function(a){j="";var b="\n-- Error details --";b+="\n\nStatusCode: ",b+=a.status?a.status:"no status code available",b+="\nMsg: ",b+=a.data.msg?a.data.msg:"no error details available",d.reject(b)}),d.promise},K=function(){var a=F(!1);a.filesInDefaultFormat=D(h().files),a.userRole=h().userRole;var d=c.defer();return f.save({projectId:b.projectId},a,function(a,b,c,e){d.resolve(a)},function(a){d.reject(a)}),d.promise};return{getProject:h,addFile:x,addFolder:y,renameNode:z,removeNode:A,getNode:p,hasNode:q,setNodeHidden:r,setProjectFromJSONdata:B,saveProjectToServer:E,compileProject:G,runProject:H,testProject:I,toolAction:J,submitProject:K,isProjectModified:n,getNodeArray:D,getNewNode:o}}]),angular.module("codeboardApp").controller("UserSettingsCtrl",["$scope","$upload","$routeParams","$http","$timeout","$log","UserResSettings","userData",function(a,b,c,d,e,f,g,h){a.data=h,a.server={saveSuccess:!1,saveFailure:!1},a.save=function(b){var d={email:b.email,emailPublic:b.emailPublic,name:b.name,url:b.url,institution:b.institution,location:b.location};g.update({username:c.username},d).$promise.then(function(b){a.server.saveSuccess=!0,e(function(){a.server.saveSuccess=!1},4e3)}),function(b){a.server.saveFailure=!0,f.debug(b)}},a.onFileSelect=function(d){for(var e=0;e<d.length;e++){d[e];a.upload=b.upload({url:"/api/users/"+c.username+"/settings/userImage",data:{myObj:a.myModelObj},file:d}).progress(function(a){console.log("percent: "+parseInt(100*a.loaded/a.total))}).success(function(b,c,d,e){console.log(b),a.data.imageUrl=b.imageUrl})}}}]),angular.module("codeboardApp").controller("UserSettingsPasswordCtrl",["$scope","$routeParams","$http","$timeout","$log",function(a,b,c,d,e){a.passwordSubmitted=!1,a.invalidCurrentPassword=!1,a.pserver={saveSuccess:!1,saveFailure:!1},a.updatePassword=function(f){if(a.pserver.saveSuccess=!1,a.pserver.saveFailure=!1,a.invalidCurrentPassword=!1,a.passwordSubmitted=!0,a.changePasswordForm.$valid&&f.newPassword===f.newPasswordConfirm){var g={currentPassword:f.currentPassword,newPassword:f.newPassword};c.put("/api/users/"+b.username+"/settings/password",g).success(function(b,c,e,f){a.pserver.saveSuccess=!0,a.formModel={},a.passwordSubmitted=!1,d(function(){a.pserver.saveSuccess=!1},8e3)}).error(function(b,c,d,f){e.debug(c+" error:"+b.msg),a.pserver.saveFailure=!0,403===c&&(a.invalidCurrentPassword=!0)})}}}]);var uploadService=angular.module("uploadService",["ngResource","angularFileUpload"]),MyCtrl=["$scope","$upload",function(a,b){a.onSendFiles=function(c){for(var d=0;d<c.length;d++){var e=c[d],f={url:"/uploadProfilePicture/"+a.userId,data:{user:a.userId},file:e};a.upload=b.upload(f).progress(function(a){}).success(function(a,b,c,d){alert(a.reply)})}}}];angular.module("codeboardApp").service("IdeMsgService",function(){this.msgDisplayFileRequest=function(a){return{msg:"ide.displayFileRequest",data:{nodeId:a}}},this.msgNewNodeRequest=function(a){return{msg:"ide.newNodeRequest",data:{nodeType:a}}},this.msgNewNodeNameAvailable=function(a,b){return{msg:"ide.newNodeNameAvailable",data:{nodeName:a,nodeType:b}}},this.msgRenameNodeRequest=function(){return{msg:"ide.renameNodeRequest"}},this.msgDisplayRenameNodeModalRequest=function(a,b,c){return{msg:"ide.displayRenameNodeModalRequest",data:{nodeId:a,nodeName:b,nodeType:c}}},this.msgRenameNodeNameAvailable=function(a,b){return{msg:"ide.renameNodeNameAvailable",data:{nodeId:a,nodeName:b}}},this.msgRemoveNodeRequest=function(){return{msg:"ide.removeNodeRequest"}},this.msgRemoveNodeConfirmation=function(a){return{msg:"ide.removeNodeConfirmation",data:{uniqueId:a}}},this.msgSaveProjectRequest=function(){return{msg:"ide.saveProjectRequest"}},this.msgHideNodeRequest=function(){return{msg:"ide.hideNodeRequest"}},this.msgCompileRequest=function(){return{msg:"ide.compileRequest"}},this.msgCompileCleanRequest=function(){return{msg:"ide.compileCleanRequest"}},this.msgRunRequest=function(){return{msg:"ide.runRequest"}},this.msgStopRequest=function(){return{msg:"ide.stopRequest"}},this.msgStoppableActionAvailable=function(){return{msg:"ide.stoppableActionAvailable"}},this.msgStoppableActionGone=function(){return{msg:"ide.stoppableActionGone"}},this.msgTestRequest=function(){return{msg:"ide.testRequest"}},this.msgToolRequest=function(){return{msg:"ide.toolRequest"}},this.msgSubmitRequest=function(){return{msg:"ide.SubmitRequest"}},this.msgDisplayEditorRequest=function(a){return{msg:"ide.displayEditorRequest",data:{displayEditor:a}}},this.msgShowOutputAsText=function(){return{msg:"ide.showOutputAsText"}},this.msgReloadTreeFromProjectFactory=function(){return{msg:"ide.reloadTreeFromProjectFactory"}},this.msgShowEditorSettingsRequest=function(a){return{msg:"ide.showEditorSettingsRequest",data:{settings:a}}},this.msgEditorSettingsChanged=function(a){return{msg:"ide.editorSettingsChanged",data:{settings:a}}},this.msgEditorResizeRequest=function(){return{msg:"ide.editorResizeRequest"}},this.msgProcessViewQueryStringRequest=function(){return{msg:"ide.processViewQueryStringRequest"}},this.msgShowShareProjectModalRequest=function(){return{msg:"ide.showShareProjectModalRequest"}}}),angular.module("codeboardApp").service("IdeSnippetsSrv",function(){this.getEiffelSnippet=function(){return[{content:"feature {${1:CLASS}} -- ${2:comment}",name:"feature modifier",tabTrigger:"feature"},{content:'note\n\tdescription : "Description of the class"\n\tauthor      : "Name of author"\n\nclass\n\t${1:CLASS_NAME}\n\ninherit\n\t${2:CLASS_INHERIT}\n\nfeature {${3:CLASS_FEATURE}} -- ${4: feature comment}\n\n\t${5:--Add your routines here}\n\nend',name:"class",tabTrigger:"class"},{content:"${1:name}: ${2:type} = ${3}",name:"const",tabTrigger:"const"},{content:"inspect\n\t${1:exp}\nwhen ${2:value} then\n\t${3:-- code 1 here}\nelse\n\t${4:-- code 2 here}\nend",name:"inspect",tabTrigger:"inspect"},{content:"when ${2:value} then\n\t${3:-- code here}",name:"when",tabTrigger:"when"},{content:"from\n\t${1}\nuntil\n\t${2}\nloop\n\t${3}\nend",name:"from loop",tabTrigger:"from_loop"},{content:"across ${1:my_list} as ${2:ic} loop ${3:print(ic.item)} end",name:"across loop",tabTrigger:"across_loop"},{content:"if ${1:exp} then\n\t${2:-- code here }\nend",name:"if",tabTrigger:"if"},{content:"if ${1:exp} then\n\t${2:-- code}\nelse\n\t${3:-- code here}\nend",name:"ifelse",tabTrigger:"ifelse"},{content:"${1:routine_name} (${2:i: INTEGER})\n\t\t${3:-- feature comment}\n\trequire\n\t\t${4:-- preconditions}\n\tdo\n\t\t${5:-- code here}\n\tensure\n\t\t${6:-- postconditions}\n\tend",name:"routine",tabTrigger:"routine"},{content:"check\n\t${1:assertion}\nend ",name:"check",tabTrigger:"check"},{content:"create ${1:var}.make (${2:arguments}) ",name:"create",tabTrigger:"create"},{content:"local\n\t${1:var}: ${2:type}",name:"local",tabTrigger:"local"},{content:'print("${1:message}%N")',name:"Hint: print message",tabTrigger:"hint_print"},{content:"from\n\tmy_list.start\nuntil\n\tmy_list.off\nloop\n\tprint (my_list.item)\n\tmy_list.forth\nend",name:"Hint: from-loop over a list",tabTrigger:"hint_from_loop_over_a_list"},{content:"across my_list as ic loop print (ic.item) end",name:"Hint: across-loop over a list",tabTrigger:"hint_across_loop_over_a_list"}]}}),angular.module("codeboardApp").service("UserSrv",["$rootScope","SessionRes","$log","$location",function(a,b,c,d){var e=!1,f="";this.getUsername=function(){return f},this.isAuthenticated=function(){return e};var g=function(a){f=a,e=!0};this.signOutUser=function(){b.remove(function(){d.path("/")}),f="",e=!1},this.tryAuthenticateUser=function(){b.get(function(b){g(b.username),a.$broadcast("userLoggedIn")},function(a){c.debug("Cannot authenticate user; Status: "+a.status)})}}]),angular.module("codeboardApp").factory("WebsocketSrv",["$websocket","$log","$window",function(a,b,c){var d=null,e=function(c,e,f,g){d=a(c),d.onOpen(function(){e()}),d.onMessage(function(a){b.debug(a.data),f(a.data)}),d.onClose(function(){b.debug("websocketSrvjs.onClose: the websocket connection was closed!"),g()}),d.onError(function(a){b.debug("websocketSrvjs.onError: websocket error")})},f=function(a){var b=a||!1;d.close(b)},g=function(a){d&&1===d.readyState?(b.debug("WebsocketSrvjs.sendData: sending data "+a),d.send(a)):b.debug("WebsocketSrvjs.sendData: not sending data; WS not initialized or readyState not 1")};return{connect:e,close:f,sendData:g}}]),angular.module("codeboardApp").service("StatsSrv",function(){var a=function(a,b){var c=new Date(a.getTime());return c.setDate(c.getDate()+b),c},b=function(b,c){return a(b,-c)},c=function(b,c,d){for(var e=b;e<=c;){var f={_id:{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()},count:0};d.push(f),e=a(e,1)}},d=function(d,e,f){var g=function(a,b){return new Date(a._id.year,a._id.month-1,a._id.day)-new Date(b._id.year,b._id.month-1,b._id.day)};f.sort(g);var h=f.length,i=864e5;if(0==h)c(d,e,f);else{var j=new Date(f[0]._id.year,f[0]._id.month-1,f[0]._id.day);if(j-d>=1){b(j,1);c(d,j,f)}var k=new Date(f[h-1]._id.year,f[h-1]._id.month-1,f[h-1]._id.day);if(e-k>=i){var l=a(k,1);c(l,e,f)}}for(var m=0;m<h-1;m++){var n=new Date(f[m]._id.year,f[m]._id.month-1,f[m]._id.day),o=new Date(f[m+1]._id.year,f[m+1]._id.month-1,f[m+1]._id.day);if(o-n>=i){var p=a(n,1),q=b(o,1);c(p,q,f)}}f.sort(g)};return{sortAndAddMissingDates:d}}),angular.module("codeboardApp").directive("ngEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.ngEnter)}),b.preventDefault())})}}),angular.module("codeboardApp").directive("ngSelectOnFocus",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){c.on("focus",function(){var b=this;a(function(){b.select()},10)})}}}]),angular.module("codeboardApp").factory("ProjectSettingsRes",["$resource",function(a){return a("/api/projects/:projectId/settings",{projectId:"@id"})}]).factory("ProjectSummaryRes",["$resource",function(a){return a("/api/projects/:projectId/summary",{projectId:"@id"})}]).factory("ProjectSubmissionRes",["$resource",function(a){return a("/api/projects/:projectId/submissions",{projectId:"@id"})}]).factory("ProjectRes",["$resource",function(a){return a("/api/projects/:projectId",{projectId:"@id"},{update:{method:"PUT"}})}]),angular.module("codeboardApp").factory("SessionRes",["$resource",function(a){return a("/api/session")}]),angular.module("codeboardApp").factory("UserRes",["$resource",function(a){return a("/api/users/:username",{username:"@username"})}]).factory("UserResSettings",["$resource",function(a){return a("/api/users/:username/settings",{username:"@username"},{update:{method:"PUT"}})}]).factory("UsersAllRes",["$resource",function(a){return a("/api/users/")}]),angular.module("codeboardApp").factory("UserProjectRes",["$resource",function(a){return a("/api/projects/:projectId/userprojects/:userprojectId",{userprojectId:"@userprojectId",projectId:"@projectId"})}]);